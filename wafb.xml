<?xml version="1.0" encoding="UTF-8" ?>
<Module>
  <ModulePrefs title="WAFB"/>
  <Content type="html">
  <![CDATA[
    <div id="content_div"></div>
    <script type="text/javascript">

      // base URL params
      var bnRegion = "us"
      var bnDomain = ".api.battle.net/wow/"
      var bnAPI = "character"
      var bnRealm = "borean-tundra"
      var character = "Peashooter"
      var bnFields = "achievements,titles"
      var bnLocale = "en_US"
      var jsonP = "?"
      var apiKey = "hevjknfvk5mss332av5gumehdp3c4ymt"

      // assemble URL
      var url = "https://"
      url += bnRegion
      url += bnDomain
      url += bnAPI
      url += "/" + bnRealm
      url += "/" + character
      url += "?fields=" + bnFields
      url += "&locale=" + bnLocale
      url += "&jsonp" + jsonP
      url += "&apikey" + bnAPI
      // for example:
      // https://us.api.battle.net/wow/character/borean-tundra/Peashooter?fields=achievements&locale=en_US&jsonp=%3F&apikey=hevjknfvk5mss332av5gumehdp3c4ymt


    function makeJSONRequest(url) {
      var params = {};
      params[gadgets.io.RequestParameters.CONTENT_TYPE] = gadgets.io.ContentType.JSON;
      // var url = "https//" gadget-doc-examples.googlecode.com/svn/trunk/opensocial-gadgets/json-data.txt";
      gadgets.io.makeRequest(url, response, params);
    };

    function response(obj) {
      var jsondata = obj.data;
      var html = "";
      // Process returned JS object as an associative array
      for (var key in jsondata) {
        var value = jsondata[key];
        html += key + ": ";
        // If 'value' is an array, render its contents as a bulleted list
        if (value instanceof Array)
        {
          html += "<br /><ul>";
          for (var i = 0; i < value.length ; i++)
          {
            html += "<li>"+ jsondata.Hobbies[i] + "</li>";
          }
          html+= "</ul>";
        }
        // If 'value' isn't an array, just write it out as a string
        else {
          html += value + "<br />";
        }
      }
      document.getElementById('content_div').innerHTML = html;
     };
     gadgets.util.registerOnLoadHandler(makeJSONRequest);

     </script>
  ]]>
  </Content>
</Module>